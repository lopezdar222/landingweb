<main data-bs-theme="dark">
    <div class="album py-5 bg-body-tertiary">
        <div class="container">
            <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                <div class="col">
                <%if (message === 'ok') {%>
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <button onclick="cargarContenidoGeneral('/principal?id_cliente=<%= datos.id_cliente %>&id_token=<%= id_token %>');">
                                <span class="ml-2"><<-- Volver</span>
                            </button>
                        </div>
                    </div>
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div id="chat-window">
                                <div id="chat-messages">
                                    <% datos2.forEach(linea => { %>
                                        <%if (!linea.misma_fecha) {%>
                                            <div class="date-divider"><%= linea.fecha_mensaje %></div>
                                        <% } %>
                                        <%if (!linea.enviado_cliente) {%>
                                            <div class="message other">
                                                <%if (linea.mensaje == '') {%>
                                                    <div class="message-content">
                                                        <a href="/descargar/<%=linea.nombre_guardado%>" 
                                                            download="<%=linea.nombre_original%>">
                                                            <%= linea.nombre_original %>
                                                        </a>
                                                    </div>
                                                <% } else {%>
                                                    <div class="message-content"><%= linea.mensaje %></div>
                                                <% } %>
                                                <div class="message-time"><%= linea.horario_mensaje %></div>
                                            </div>
                                        <% } else {%>
                                            <div class="message self">
                                                <%if (linea.mensaje == '') {%>
                                                    <div class="message-content">
                                                        <a href="/descargar/<%=linea.nombre_guardado%>" 
                                                            download="<%=linea.nombre_original%>">
                                                            <%= linea.nombre_original %>
                                                        </a>
                                                    </div>
                                                <% } else {%>
                                                    <div class="message-content"><%= linea.mensaje %></div>
                                                <% } %>
                                                <div class="message-time"><%= linea.horario_mensaje %></div>
                                            </div>
                                        <% } %>
                                    <% }); %>
                                </div>
                                <div id="input-area">
                                    <textarea id="message-input" placeholder="Tu mensaje aqu√≠..." rows="2" cols="40" maxlength="200"></textarea>
                                </div>
                                <div id="input-area">
                                    <!--input type="text" id="message-input" placeholder="Escribe tu mensaje aqu√≠" class="message self" rows="4" cols="50"-->
                                    <select id="emoticones" onchange="insertarEmoticon()">
                                        <option value="sel">Emojis</option>
                                        <option value="üòä">üòä</option>
                                        <option value="üòÑ">üòÑ</option>
                                        <option value="üòç">üòç</option>
                                        <option value="üòÇ">üòÇ</option>
                                        <option value="üòé">üòé</option>
                                        <option value="üòâ">üòâ</option>
                                        <option value="üòÅ">üòÅ</option>
                                        <option value="üòÖ">üòÖ</option>
                                        <option value="ü•∞">ü•∞</option>
                                        <option value="ü§£">ü§£</option>
                                        <option value="üòá">üòá</option>
                                        <option value="ü§ó">ü§ó</option>
                                        <option value="üòå">üòå</option>
                                        <option value="üòè">üòè</option>
                                        <option value="üò¨">üò¨</option>
                                        <option value="ü§î">ü§î</option>
                                        <option value="üò¥">üò¥</option>
                                        <option value="üò¢">üò¢</option>
                                        <option value="üò≠">üò≠</option>
                                        <option value="üòû">üòû</option>
                                        <option value="üòî">üòî</option>
                                        <option value="üòï">üò¨</option>
                                        <option value="üòï">üòï</option>
                                        <option value="üòü">üòü</option>
                                        <option value="üò•">üò•</option>
                                        <option value="üòì">üòì</option>
                                        <option value="üò´">üò´</option>
                                        <option value="üò©">üò©</option>
                                    </select>
                                    <button id="send-button" onclick="cargarContenidoChats(<%=id_cliente%>, document.getElementById('message-input').value);">Enviar</button>
                                </div>
                                <div id="input-area">
                                    <button id="attach-button" onclick="document.getElementById('file-input').click();">Adjuntar</button>
                                    <input type="file" id="file-input" style="display: none;" accept=".jpg, .png, .pdf, .bmp" onchange="mostrarNombreAdjunto()">
                                </div>
                                <div id="input-area">
                                    <p id="nombre_archivo"></p>
                                </div>
                                <div id="input-area">
                                    <p id="resultado_envio_adjunto"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <%if (datos.contacto_whatsapp != '') {%>
                                <button class="rounded-lg text-xs md:text-sm font-bold flex justify-center items-center disabled:opacity-40 transition py-4 relative	bg-custom-violet hover:text-gray-300 border border-custom-violet hover:border-custom-yellow w-full mb-3">
                                    <a href="https://wa.me/<%= datos.contacto_whatsapp %>" target="_blank">
                                        <span class="ml-2">Contacto Whatsapp</span>
                                    </a>
                                </button>
                            <%} %>
                            <%if (datos.contacto_telegram != '') {%>
                                <button class="rounded-lg text-xs md:text-sm font-bold flex justify-center items-center disabled:opacity-40 transition py-4 relative	bg-custom-violet hover:text-gray-300 border border-custom-violet hover:border-custom-yellow w-full mb-3">
                                    <a href="https://<%= datos.contacto_telegram %>" target="_blank">
                                        <span class="ml-2">Contacto Telegram</span>
                                    </a>
                                </button>
                            <%} %>
                        </div>
                    </div>
                <%} else {%>
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <p class="card-text"><%= message %> </p>
                            <button onclick="cerrar_Sesion_Token_Invalido()">
                                <span class="ml-2"><<-- Volver al Inicio</span>
                            </button>
                        </div>
                    </div>
                <%}  %>
                </div>
            </div>
        </div>
    </div>
</main>